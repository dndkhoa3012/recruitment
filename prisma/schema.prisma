// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Category {
  id          String   @id @default(uuid())
  name        String   @unique
  slug        String   @unique
  description String?  @db.Text
  
  jobs        Job[]
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Job {
  id          String   @id @default(uuid())
  title       String   // Job title
  department  String?  // Department/Category (legacy - will be replaced by categoryId)
  categoryId  String?  // Category relationship
  category    Category? @relation(fields: [categoryId], references: [id], onDelete: SetNull)
  location    String   // Work location
  type        String   @default("full-time") // full-time, part-time, contract, internship
  salary      String?  // Salary range (e.g., "15-20 triệu VNĐ")
  description String?  @db.Text // Job description
  requirements String? @db.Text // Job requirements
  benefits    String?  @db.Text // Benefits
  status      String   @default("active") // active, inactive, closed
  publishedAt DateTime? // When job was published
  deadline    DateTime? // Application deadline
  
  candidates  Candidate[]
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([categoryId])
}

model Candidate {
  id          String   @id @default(uuid())
  fullName    String   // Full name
  email       String   // Email
  phone       String   // Phone number
  resume      String?  @db.Text // Resume file URL or text
  coverLetter String?  @db.Text // Cover letter
  status      String   @default("pending") // pending, reviewing, interviewed, accepted, rejected
  appliedAt   DateTime @default(now())
  
  jobId       String
  job         Job      @relation(fields: [jobId], references: [id], onDelete: Cascade)
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([jobId])
  @@index([email])
}

// ==========================================
// LEGACY MODELS (Required for build)
// ==========================================

model Menu {
  id          String        @id @default(uuid())
  name        String
  price       String?
  description String?       @db.Text
  image       String?       @db.Text
  categoryId  String
  category    MenuCategory  @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt

  @@index([categoryId])
}

model MenuCategory {
  id          String   @id @default(uuid())
  name        String
  color       String?  @default("default")
  layoutType  String?  @default("grid")
  isFeatured  Boolean  @default(false)
  menus       Menu[]
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model GalleryCategory {
  id          String   @id @default(uuid())
  name        String
  description String?  @db.Text
  collections GalleryCollection[]
  images      GalleryImage[]
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model GalleryCollection {
  id          String   @id @default(uuid())
  name        String
  description String?  @db.Text
  coverImage  String?  @db.Text
  categoryId  String
  category    GalleryCategory @relation(fields: [categoryId], references: [id])
  images      GalleryImage[]
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model GalleryImage {
  id           String   @id @default(uuid())
  src          String   @db.Text
  alt          String?
  collectionId String?
  collection   GalleryCollection? @relation(fields: [collectionId], references: [id])
  categoryId   String?
  category     GalleryCategory? @relation(fields: [categoryId], references: [id])
  order        Int      @default(0)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Banner {
  id          String   @id @default(uuid())
  pageType    String
  deviceType  String   @default("DESKTOP")
  title       String?
  subtitle    String?
  imageUrls   Json
  altText     String?
  isActive    Boolean  @default(true)
  order       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Booking {
  id           String   @id @default(uuid())
  customerName String
  phoneNumber  String
  email        String?
  bookingDate  DateTime
  time         String
  guestCount   Int
  area         String?
  note         String?
  status       String   @default("pending")
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model EventCategory {
  id        String   @id @default(uuid())
  name      String
  color     String?  @default("default")
  events    Event[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Event {
  id          String         @id @default(uuid())
  name        String
  date        DateTime
  poster      String?        @db.Text
  description String?        @db.Text
  content     String?        @db.Text
  location    String?
  price       Int            @default(0)
  startTime   String?
  endTime     String?
  isFeatured  Boolean        @default(false)
  isHidden    Boolean        @default(false)
  
  categoryId  String?
  category    EventCategory? @relation(fields: [categoryId], references: [id])
  
  itinerary   Json?
  timeline    Json?
  
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt
}
